<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Campaigns</h3>
  <div>
    <%= link_to "New Campaign", new_admin_campaign_path, class: "btn btn-primary" %>
  </div>
</div>

<b><%= @count %></b> results

<div class="card table-responsive">
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th colspan="2"></th>
        <th colspan="2" class="text-center">Campaign</th>
        <th colspan="4" class="text-center">Execution</th>
        <th colspan="1">Audience</th>
        <th colspan="3" class="text-center">Incentive</th>
        <th colspan="1">Calculation</th>
        <th colspan="4"></th>
      </tr>
      <tr>
        <th><%= sort_link("From", "from_date") %></th>
        <th><%= sort_link("To", "to_date") %></th>
        <th><%= sort_link("Name", "campaign_name") %></th>
        <th><%= sort_link("Types", "campaign_type") %></th>
        <th><%= sort_link("Type", "execution_type") %></th>
        <th><%= sort_link("Frequency", "frequency") %></th>
        <th><%= sort_link("Next", "next_executed_at") %></th>
        <th><%= sort_link("Last", "last_executed_at") %></th>
        <th><%= sort_link("Type", "audience_type") %></th>
        <th><%= sort_link("Type", "reward_type") %></th>
        <th><%= sort_link("Currency", "reward_currency") %></th>
        <th><%= sort_link("Amount", "reward_amount") %></th>
        <th><%= sort_link("Type", "calculation_type") %></th>
        <th><%= sort_link("Occurence", "occurence") %></th>
        <th><%= sort_link("Description", "description") %></th>
        <th><%= sort_link("Status", "status") %></th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% @campaigns.each do |campaign| %>
        <tr>
          <td><%= Time.parse(campaign["from_date"]) %></td>
          <td><%= Time.parse(campaign["to_date"]) %></td>
          <td><%= campaign["campaign_name"] %></td>
          <td><%= campaign["campaign_type"] %></td>
          <td><%= campaign["execution_type"] %></td>
          <td><%= campaign["frequency"] || "-" %></td>
          <td>
            <% if campaign["next_executed_at"] %>
              <%= Time.parse(campaign["next_executed_at"]) %>
            <% else %>
              -
            <% end %>
          </td>
          <td>
            <% if campaign["last_executed_at"] %>
              <%= Time.parse(campaign["last_executed_at"]) %>
            <% else %>
              -
            <% end %>
          </td>
          <td><%= campaign["audience_type"] %></td>
          <td><%= campaign["reward_type"] %></td>
          <td><%= campaign["reward_currency"] %></td>
          <td><%= campaign["reward_amount"] %></td>
          <td><%= campaign["calculation_type"] %></td>
          <td><%= campaign["occurence"] %></td>
          <td><%= campaign["description"] %></td>
          <td class="text-<%= campaign["status"] == 'ACTIVE' ? 'success' : 'danger' %>"><%= campaign["status"] %></td>
          <td><%= link_to "View", admin_campaign_path(campaign["id"]) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<%= paginate @campaigns %>
